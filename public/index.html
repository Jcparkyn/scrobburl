<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8">
  <title>Main</title>
  <link rel="stylesheet" href="main.css">
  <script src="main.js"></script>
</head>
<body>
  <div id="myapp">Fetching dictionary...</div>
  <script>
    customElements.define('scroll-repeat', class extends HTMLElement {
      constructor() { super(); }
      connectedCallback() {
        const onScroll = () => {
          const { scrollTop, scrollLeft } = this;
          const scrollResetDistance = (55 + 4) * 14;
          if (scrollTop === 0) {
            this.scrollTop = scrollResetDistance;
          }
          else if (scrollTop > scrollResetDistance) {
            this.scrollTop = 1;
          }
          else if (scrollLeft === 0) {
            this.scrollLeft = scrollResetDistance;
          }
          else if (scrollLeft > scrollResetDistance) {
            this.scrollLeft = 1;
          }
        };
        this.addEventListener("scroll", onScroll);
      }
    });
    const start = async () => {
      const wordlist = await fetch('dictionary.txt').then(res => res.text());
      // This seed isn't perfect, but it doesn't matter too much
      const seed = Math.floor(Math.random() * Number.MAX_SAFE_INTEGER);
      const app = Elm.Main.init({
        node: document.getElementById('myapp'),
        flags: {
          wordlist,
          initialSeed: seed,
        }
      });
    }
    start();
  </script>
</body>
</html>